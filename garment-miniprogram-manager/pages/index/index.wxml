<!-- pages/index/index.wxml - ç®¡ç†ç«¯é¦–é¡µ -->
<view class="container">
  <!-- å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
  <view class="header">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" />
      <view class="user-details">
        <text class="username">{{userInfo.name || 'ç®¡ç†å‘˜'}}</text>
        <text class="role">{{userInfo.role || 'ç”Ÿäº§ä¸»ç®¡'}}</text>
      </view>
    </view>
    <view class="current-time">
      <text class="time">{{currentTime}}</text>
      <text class="date">{{currentDate}}</text>
    </view>
  </view>

  <!-- ä»Šæ—¥æ¦‚è§ˆ -->
  <view class="overview-section">
    <view class="section-title">ä»Šæ—¥æ¦‚è§ˆ</view>
    <view class="overview-cards">
      <view class="overview-card">
        <view class="card-value">{{todayStats.totalProduction || 0}}</view>
        <view class="card-label">æ€»äº§é‡</view>
        <view class="card-change {{todayStats.productionChange >= 0 ? 'positive' : 'negative'}}">
          {{todayStats.productionChange >= 0 ? '+' : ''}}{{todayStats.productionChange || 0}}%
        </view>
      </view>
      <view class="overview-card">
        <view class="card-value">{{todayStats.activeWorkers || 0}}</view>
        <view class="card-label">åœ¨å²—äººæ•°</view>
        <view class="card-change positive">{{todayStats.totalWorkers || 0}}äºº</view>
      </view>
      <view class="overview-card">
        <view class="card-value">{{todayStats.completionRate || 0}}%</view>
        <view class="card-label">å®Œæˆç‡</view>
        <view class="card-change {{todayStats.completionChange >= 0 ? 'positive' : 'negative'}}">
          {{todayStats.completionChange >= 0 ? '+' : ''}}{{todayStats.completionChange || 0}}%
        </view>
      </view>
      <view class="overview-card">
        <view class="card-value">{{todayStats.qualityRate || 0}}%</view>
        <view class="card-label">è´¨é‡åˆæ ¼ç‡</view>
        <view class="card-change {{todayStats.qualityChange >= 0 ? 'positive' : 'negative'}}">
          {{todayStats.qualityChange >= 0 ? '+' : ''}}{{todayStats.qualityChange || 0}}%
        </view>
      </view>
    </view>
  </view>

  <!-- è½¦é—´çŠ¶æ€ -->
  <view class="workshop-section">
    <view class="section-title">
      <text>è½¦é—´çŠ¶æ€</text>
      <text class="refresh-btn" bindtap="refreshWorkshopStatus">åˆ·æ–°</text>
    </view>
    <scroll-view class="workshop-list" scroll-x="true">
      <view class="workshop-item" wx:for="{{workshopList}}" wx:key="id">
        <view class="workshop-header">
          <text class="workshop-name">{{item.name}}</text>
          <view class="workshop-status {{item.status}}">
            <text>{{item.statusText}}</text>
          </view>
        </view>
        <view class="workshop-stats">
          <view class="stat-item">
            <text class="stat-value">{{item.currentProduction}}</text>
            <text class="stat-label">å½“å‰äº§é‡</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{item.activeWorkers}}</text>
            <text class="stat-label">åœ¨å²—äººæ•°</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{item.efficiency}}%</text>
            <text class="stat-label">æ•ˆç‡</text>
          </view>
        </view>
        <view class="workshop-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.completionRate}}%"></view>
          </view>
          <text class="progress-text">{{item.completionRate}}%</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- å¾…å¤„ç†äº‹é¡¹ -->
  <view class="pending-section">
    <view class="section-title">
      <text>å¾…å¤„ç†äº‹é¡¹</text>
      <text class="view-all" bindtap="viewAllPending">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view class="pending-list">
      <view class="pending-item" wx:for="{{pendingList}}" wx:key="id" bindtap="handlePendingItem" data-item="{{item}}">
        <view class="pending-icon {{item.type}}">
          <text class="iconfont">{{item.icon}}</text>
        </view>
        <view class="pending-content">
          <text class="pending-title">{{item.title}}</text>
          <text class="pending-desc">{{item.description}}</text>
          <text class="pending-time">{{item.createTime}}</text>
        </view>
        <view class="pending-priority {{item.priority}}">
          <text>{{item.priorityText}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="actions-section">
    <view class="section-title">å¿«æ·æ“ä½œ</view>
    <view class="action-grid">
      <view class="action-item" bindtap="navigateToScan">
        <view class="action-icon scan">
          <text class="iconfont">ğŸ“·</text>
        </view>
        <text class="action-label">æ‰«ç æ”¶åŒ…</text>
      </view>
      <view class="action-item" bindtap="navigateToStats">
        <view class="action-icon stats">
          <text class="iconfont">ğŸ“Š</text>
        </view>
        <text class="action-label">ç”Ÿäº§ç»Ÿè®¡</text>
      </view>
      <view class="action-item" bindtap="navigateToApproval">
        <view class="action-icon approval">
          <text class="iconfont">âœ…</text>
        </view>
        <text class="action-label">å®¡æ‰¹ç®¡ç†</text>
      </view>
      <view class="action-item" bindtap="exportReport">
        <view class="action-icon export">
          <text class="iconfont">ğŸ“‹</text>
        </view>
        <text class="action-label">å¯¼å‡ºæŠ¥è¡¨</text>
      </view>
    </view>
  </view>

  <!-- å®æ—¶é€šçŸ¥ -->
  <view class="notification-section" wx:if="{{notifications.length > 0}}">
    <view class="section-title">å®æ—¶é€šçŸ¥</view>
    <view class="notification-list">
      <view class="notification-item" wx:for="{{notifications}}" wx:key="id">
        <view class="notification-dot {{item.type}}"></view>
        <view class="notification-content">
          <text class="notification-text">{{item.message}}</text>
          <text class="notification-time">{{item.time}}</text>
        </view>
      </view>
    </view>
  </view>
</view>




